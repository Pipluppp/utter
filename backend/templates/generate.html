{% extends "base.html" %}

{% block title %}Generate Speech - Utter{% endblock %}

{% block content %}
<h1 class="title-page">Generate Speech</h1>

<details class="page-guide">
    <summary>
        <span>ℹ️ Tips for Best Results</span>
        <span class="page-guide-chevron">▼</span>
    </summary>
    <div class="page-guide-content">
        <ul>
            <li><strong>Max text:</strong> 5,000 characters per generation</li>
            <li><strong>Punctuation:</strong> Use periods for pauses, commas for brief breaks</li>
            <li><strong>First generation:</strong> May take longer while the system warms up</li>
            <li><strong>Subsequent:</strong> Faster after the first generation</li>
        </ul>
    </div>
</details>

<form id="generate-form">
    <div id="error-container" class="message hidden"></div>

    <div class="form-group">
        <label class="input-label" for="voice-select">Voice</label>
        <select class="select" id="voice-select" required>
            <option value="">Select a voice...</option>
        </select>
    </div>

    <div class="form-group">
        <label class="input-label" for="language-select">Language</label>
        <select class="select" id="language-select">
            <option value="Auto" selected>Auto-detect</option>
            <option value="English">English</option>
            <option value="Chinese">Chinese</option>
            <option value="Japanese">Japanese</option>
            <option value="Korean">Korean</option>
            <option value="German">German</option>
            <option value="French">French</option>
            <option value="Russian">Russian</option>
            <option value="Portuguese">Portuguese</option>
            <option value="Spanish">Spanish</option>
            <option value="Italian">Italian</option>
        </select>
    </div>

    <div class="form-group">
        <label class="input-label" for="text-input">Text</label>
        <textarea class="textarea" id="text-input" placeholder="Enter text to speak..." maxlength="10000"
            required></textarea>
        <div class="char-counter" id="char-counter">0 / 10000</div>
    </div>

    <div class="message">
        Tips: Use commas for pauses. End sentences with periods.
    </div>

    <button type="submit" class="btn btn-block" id="generate-btn">
        Generate Speech
    </button>
</form>

<!-- Generation Progress (shown during generation) -->
<div class="generation-progress hidden" id="generation-progress">
    <div class="progress-spinner"></div>
    <div class="progress-info">
        <div class="progress-title">Generating speech...</div>
        <div class="progress-status" id="progress-status">Preparing...</div>
        <div class="progress-time">
            <span class="progress-elapsed" id="progress-elapsed">0:00</span>
            <span class="progress-elapsed-label">elapsed</span>
        </div>
        <div class="progress-hint">First generation may take 30–90s while the GPU warms up</div>
    </div>
</div>

<div class="result-section hidden" id="result-section">
    <div class="divider"></div>

    <div class="audio-player" id="audio-player">
        <button type="button" class="audio-player-btn" id="play-btn">
            <svg id="play-icon" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                <path d="M8 5v14l11-7L8 5z" />
            </svg>
            <svg id="pause-icon" viewBox="0 0 24 24" fill="currentColor" class="hidden" aria-hidden="true">
                <path d="M6 4h4v16H6V4zm8 0h4v16h-4V4z" />
            </svg>
        </button>

        <div id="waveform" class="audio-player-waveform"></div>

        <div class="audio-player-time" id="time-display">0:00 / 0:00</div>

        <div class="audio-player-download">
            <a href="#" class="btn btn-secondary" id="download-btn" download="speech.mp3">
                Download
            </a>
        </div>
    </div>

    <audio id="audio-element" hidden></audio>
</div>


{% endblock %}
