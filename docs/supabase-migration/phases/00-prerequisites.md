# Phase 00 — Repo Prerequisites

> **Status**: Not Started
> **Prerequisites**: None
> **Goal**: Set up the repo-level tooling so `supabase` CLI commands work from the project root. No Supabase containers yet — just the scaffolding.

---

## Why this phase exists

The Supabase CLI needs to be pinned as a devDependency (not globally installed) so every contributor uses the same version. We also need npm scripts that wrap common CLI commands, because the raw commands have flags that are easy to forget (`--env-file`, `--no-verify-jwt`).

---

## Steps

### 1. Ensure Docker Desktop is running

- [ ] Verify Docker is installed: `docker --version` in terminal
- [ ] If not installed, see [manual-steps.md](../manual-steps.md#install-docker-desktop-if-not-already-installed) for install instructions
- [ ] Verify Docker daemon is running: `docker info` should print system info (not an error)

**Why**: `supabase start` launches ~10 Docker containers (Postgres, Auth, Storage, Studio, etc.). Without Docker, nothing works.

### 2. Create repo-root `package.json`

- [ ] Create `package.json` in the repo root (not inside `frontend/`)

```json
{
  "private": true,
  "name": "utter",
  "scripts": {
    "sb:start": "supabase start",
    "sb:stop": "supabase stop",
    "sb:reset": "supabase db reset",
    "sb:serve": "supabase functions serve api --env-file ./supabase/.env.local --no-verify-jwt",
    "sb:status": "supabase status"
  },
  "devDependencies": {
    "supabase": "^1.200.0"
  }
}
```

**What to change**: Create this file at `C:\Users\Duncan\Desktop\utter\package.json`.

**Why `private: true`**: Prevents accidental `npm publish`.

**Why `devDependencies`**: Everyone on the team gets the same CLI version via `npm install`. No global install drift.

### 3. Install dependencies

- [ ] Run `npm install` from repo root
- [ ] Verify: `npx supabase --version` prints a version number

**What to verify**: The `node_modules/.bin/supabase` binary exists after install.

### 4. Update `.gitignore`

- [ ] Add these entries to the repo-root `.gitignore`:

```gitignore
# Supabase local
supabase/.env.local
supabase/.temp/
```

**Why**: `supabase/.env.local` will contain Modal endpoint secrets. Must never be committed. `.temp/` is used by the CLI during operations.

### 5. (Optional) Install Deno for IDE support

- [ ] See [manual-steps.md](../manual-steps.md#optional-install-deno-for-ide-support) if you want autocomplete in Edge Function files
- [ ] Not required to run anything — purely for developer experience

---

## Files created

| File | Purpose |
|------|---------|
| `package.json` (repo root) | Supabase CLI devDependency + npm scripts |
| `package-lock.json` (repo root) | Lockfile (auto-generated by `npm install`) |

## Files modified

| File | Change |
|------|--------|
| `.gitignore` | Add `supabase/.env.local` and `supabase/.temp/` |

---

## Acceptance criteria

- [ ] `npx supabase --version` prints a version from repo root
- [ ] `npm run sb:start` is a valid command (don't run it yet — Phase 01 will)
- [ ] `supabase/.env.local` is in `.gitignore`
- [ ] No `node_modules/` or lockfile issues when running `npm install` in repo root (should not conflict with `frontend/package.json`)

---

## Notes

- The repo-root `package.json` is separate from `frontend/package.json`. They have independent `node_modules/`. This is intentional — the frontend uses Vite/React, the root just hosts the Supabase CLI.
- If `npm run sb:start` ever fails with "Docker not running", check that Docker Desktop is actually started (system tray on Windows).
